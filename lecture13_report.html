<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>13ì°¨ì‹œ í•µì‹¬ ì½”ë“œ ë³´ê³ ì„œ (ì´ˆì‹¬ììš©)</title>
<style>
:root{
  --bg0:#070A12;
  --bg1:#0B1020;
  --card:#10192E;
  --card2:#0E1629;
  --line:#22304f;
  --text:#EAF0FF;
  --muted:#B7C3E6;
  --accent:#7AA2FF;
  --good:#37D67A;
  --warn:#FFB020;
  --bad:#FF5C5C;
  --purple:#B592FF;
  --cyan:#35D0FF;
  --shadow: 0 10px 30px rgba(0,0,0,.35);
}
*{box-sizing:border-box}
body{
  margin:0;
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Arial,sans-serif;
  background: radial-gradient(1200px 600px at 20% -10%, rgba(122,162,255,.18), transparent 55%),
              radial-gradient(900px 500px at 90% 10%, rgba(53,208,255,.12), transparent 55%),
              linear-gradient(180deg,var(--bg0),var(--bg1) 40%,var(--bg0));
}
a{color:var(--accent);text-decoration:none}
a:hover{text-decoration:underline}
.container{max-width:1120px;margin:0 auto;padding:22px 16px 60px;}
.grid{
  display:grid;
  grid-template-columns: 280px 1fr;
  gap:16px;
}
@media (max-width: 980px){
  .grid{grid-template-columns: 1fr;}
  .toc{position:relative;top:auto}
}
header{
  padding:18px 18px;
  border:1px solid var(--line);
  border-radius:18px;
  background:rgba(16,25,46,.85);
  box-shadow: var(--shadow);
}
h1{margin:0 0 6px;font-size:28px;letter-spacing:-.2px}
.meta{margin:0;color:var(--muted);font-size:14px;line-height:1.5}
.badges{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
.badge{
  display:inline-flex;align-items:center;gap:8px;
  padding:6px 10px;border-radius:999px;
  background:rgba(122,162,255,.14);
  border:1px solid rgba(122,162,255,.28);
  color:#dbe6ff;font-size:12px;
}
.dot{width:8px;height:8px;border-radius:50%;}
.dot.good{background:var(--good)}
.dot.cyan{background:var(--cyan)}
.dot.purple{background:var(--purple)}
.dot.warn{background:var(--warn)}
.toc{
  position:sticky;top:16px;
  padding:14px;
  border:1px solid var(--line);
  border-radius:18px;
  background:rgba(16,25,46,.70);
  box-shadow: var(--shadow);
}
.toc h2{margin:0 0 10px;font-size:16px;color:#dbe6ff}
.toc a{display:block;padding:8px 10px;border-radius:12px;color:var(--text);border:1px solid transparent}
.toc a:hover{background:rgba(122,162,255,.10);border-color:rgba(122,162,255,.20)}
.card{
  padding:18px;
  border:1px solid var(--line);
  border-radius:18px;
  background:rgba(16,25,46,.70);
  box-shadow: var(--shadow);
  margin-bottom:16px;
}
.card h2{margin:0 0 10px;font-size:20px}
.card h3{margin:16px 0 8px;font-size:16px;color:#dbe6ff}
p{margin:8px 0;color:var(--text);line-height:1.7}
ul{margin:8px 0 0 18px;color:var(--text)}
li{margin:8px 0;color:var(--text);line-height:1.6}
.callout{
  display:flex;gap:12px;align-items:flex-start;
  padding:12px 14px;border-radius:16px;border:1px solid var(--line);
  background:rgba(7,11,21,.65);
  margin:10px 0;
}
.icon{
  width:34px;height:34px;border-radius:12px;
  display:grid;place-items:center;
  font-weight:800;
}
.icon.good{background:rgba(55,214,122,.16);border:1px solid rgba(55,214,122,.35);color:#bdf7d3}
.icon.warn{background:rgba(255,176,32,.16);border:1px solid rgba(255,176,32,.35);color:#ffe0a6}
.icon.cyan{background:rgba(53,208,255,.14);border:1px solid rgba(53,208,255,.30);color:#bdefff}
.icon.purple{background:rgba(181,146,255,.14);border:1px solid rgba(181,146,255,.30);color:#eadcff}
.small{color:var(--muted);font-size:13px}
pre.code{
  margin:10px 0 0;
  padding:14px 14px;
  border-radius:16px;
  overflow:auto;
  background:linear-gradient(180deg, #060913, #070b15);
  border:1px solid #1e2a47;
  color:#e8eefc;
  font-size:13px;
  line-height:1.55;
}
code{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
table{width:100%;border-collapse:separate;border-spacing:0;margin-top:10px;overflow:hidden;border-radius:16px}
th,td{border:1px solid var(--line);padding:12px;vertical-align:top}
th{background:rgba(122,162,255,.10);text-align:left}
tr td:first-child{width:32%}
hr.sep{border:0;border-top:1px dashed rgba(122,162,255,.25);margin:14px 0}
footer{margin-top:10px;color:var(--muted);font-size:12px;text-align:center}
kbd{
  background:rgba(122,162,255,.12);
  border:1px solid rgba(122,162,255,.22);
  border-bottom-color:rgba(122,162,255,.35);
  padding:2px 6px;border-radius:8px;font-size:12px;color:#dbe6ff;
}
</style>
</head>
<body>
<div class="container">
<header>
  <h1>13ì°¨ì‹œ í•µì‹¬ ì½”ë“œ ë³´ê³ ì„œ <span class="badge"><span class="dot cyan"></span>ì´ˆì‹¬ììš©</span></h1>
  <p class="meta">ì‘ì„±ì¼: 2026-01-29 Â· ëª©í‘œ: â€œì½”ë“œë¥¼ ë”°ë¼ ì¹˜ë©´ ê·¸ëŒ€ë¡œ ë™ì‘â€ + â€œì™œ ê·¸ëŸ°ì§€ ì„¤ëª…ê¹Œì§€â€</p>
  <div class="badges">
    <span class="badge"><span class="dot good"></span>ì „ì²˜ë¦¬ ë¶„ë¦¬</span>
    <span class="badge"><span class="dot warn"></span>ì‹œê°í™”(permute)</span>
    <span class="badge"><span class="dot purple"></span>FC êµì²´</span>
    <span class="badge"><span class="dot cyan"></span>running_loss</span>
  </div>
</header>

<div class="grid">
  <nav class="toc">
    <h2>ëª©ì°¨</h2>
<a href="#goal">í•™ìŠµ ëª©í‘œ</a><a href="#core">í•µì‹¬ ê°œë…(ì´ˆì‹¬ììš©)</a><a href="#flow">ì „ì²´ íë¦„ í•œ ì¥ ìš”ì•½</a><a href="#codes">í•µì‹¬ ì½”ë“œ(ì£¼ì„ ë§ìŒ)</a><a href="#pitfalls">ìì£¼ ë‚˜ëŠ” ì‹¤ìˆ˜(ì—ëŸ¬)</a><a href="#template">ë³´ê³ ì„œ í¬ë§· í…œí”Œë¦¿</a>
    <hr class="sep"/>
    <div class="small">íŒ: ì½”ë“œ ë¸”ë¡ì€ ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ë„ ë™ì‘í•˜ë„ë¡ ì£¼ì„ì„ ë§ì´ ë‹¬ì•„ë†¨ì–´ìš”.</div>
  </nav>

  <main>
<section class="card" id="goal"><h2>í•™ìŠµ ëª©í‘œ</h2>
<div class="callout">
  <div class="icon cyan">ğŸ¯</div>
  <div>
    <b>ì˜¤ëŠ˜ ëª©í‘œ(ì´ 4ê°œë§Œ í™•ì‹¤íˆ)</b>
    <ul>
      <li>train/test ì „ì²˜ë¦¬ë¥¼ ë¶„ë¦¬í•´ì„œ â€œí•™ìŠµì€ ë‹¤ì–‘í•˜ê²Œ, í‰ê°€ëŠ” ì¼ì •í•˜ê²Œâ€ ë§Œë“ ë‹¤.</li>
      <li>ì •ê·œí™”ëœ í…ì„œë¥¼ ì‚¬ëŒ ëˆˆìœ¼ë¡œ ë³´ê¸° ì¢‹ê²Œ ë˜ëŒë ¤(imshow) ì¶œë ¥í•œë‹¤.</li>
      <li>pretrained ëª¨ë¸ì„ ë¶ˆëŸ¬ì˜¤ê³  ë§ˆì§€ë§‰ FCë¥¼ í´ë˜ìŠ¤ ê°œìˆ˜ì— ë§ê²Œ êµì²´í•œë‹¤.</li>
      <li>ì˜ˆì¸¡ ì¸ë±ìŠ¤ ì¶”ì¶œ(torch.max/argmax)ê³¼ epoch í‰ê·  loss(running_loss)ë¥¼ ì •í™•íˆ ê³„ì‚°í•œë‹¤.</li>
    </ul>
  </div>
</div>
<p class="small">â€» â€œì™œ shuffleì„ ë‹¤ë¥´ê²Œ í•˜ëƒâ€, â€œpermuteê°€ ì™œ í•„ìš”í•˜ëƒâ€, â€œlossì— ì™œ batch_sizeë¥¼ ê³±í•˜ëƒâ€ê°€ ì˜¤ëŠ˜ í•µì‹¬ í¬ì¸íŠ¸ì…ë‹ˆë‹¤.</p>
</section>
<section class="card" id="core"><h2>í•µì‹¬ ê°œë… (ì´ˆì‹¬ììš© ì„¤ëª…)</h2><ul><li><b>ì „ì²˜ë¦¬(train/test ë¶„ë¦¬)</b>: trainì—ëŠ” ì¦ê°•(ëœë¤ ë’¤ì§‘ê¸° ë“±)ì„ ë„£ì–´ ëª¨ë¸ì´ ë‹¤ì–‘í•œ ìƒí™©ì„ ë³´ê²Œ í•¨. testëŠ” í‰ê°€ê°€ ëª©ì ì´ë¯€ë¡œ ì¡°ê±´ì„ ê³ ì •.</li><li><b>shuffle ì˜µì…˜</b>: trainì€ shuffle=Trueë¡œ ì„ì–´ í•™ìŠµ í¸í–¥ì„ ì¤„ì„. testëŠ” ë³´í†µ shuffle=Falseë¡œ ê²°ê³¼ í™•ì¸/ë””ë²„ê¹…ì´ ì‰¬ì›€.</li><li><b>permute(1,2,0) ì˜ë¯¸</b>: PyTorch ì´ë¯¸ì§€ 1ì¥ í…ì„œëŠ” (C,H,W). matplotlibì€ (H,W,C)ë¥¼ ê¸°ëŒ€ â†’ ì°¨ì› ìˆœì„œ ë°”ê¾¸ê¸°.</li><li><b>FC êµì²´ ì˜ë¯¸</b>: íŠ¹ì§• ì¶”ì¶œë¶€ëŠ” ê·¸ëŒ€ë¡œ(ì´ë¯¸ í•™ìŠµë¨). ë§ˆì§€ë§‰ ë¶„ë¥˜ê¸°ë§Œ â€˜ìš°ë¦¬ ë°ì´í„° í´ë˜ìŠ¤ ìˆ˜â€™ë¡œ ë°”ê¾¸ë©´ ì „ì´í•™ìŠµ ê°€ëŠ¥.</li><li><b>ì˜ˆì¸¡ ì¸ë±ìŠ¤</b>: outputsëŠ” (B,C). dim=1ì—ì„œ ìµœëŒ“ê°’ ì¸ë±ìŠ¤ê°€ ì˜ˆì¸¡ í´ë˜ìŠ¤.</li><li><b>running_loss</b>: ë°°ì¹˜ lossê°€ í‰ê· (mean)ì´ë©´, lossÃ—batch_sizeë¡œ ëˆ„ì í•´ì•¼ â€˜ì „ì²´ í‰ê· â€™ì´ ì •í™•í•¨(ë§ˆì§€ë§‰ ë°°ì¹˜ í¬ê¸° ë•Œë¬¸).</li><li><b>í´ë˜ìŠ¤ë³„ ì •í™•ë„</b>: ë°°ì¹˜ ìˆœì„œì™€ ë¬´ê´€. labels[i](ì •ë‹µ í´ë˜ìŠ¤ ë²ˆí˜¸)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê·¸ í´ë˜ìŠ¤ ì¹¸(correct/total)ì— ëˆ„ì .</li></ul></section><section class="card" id="flow"><h2>ì „ì²´ íë¦„ í•œ ì¥ ìš”ì•½</h2><div class="callout"><div class="icon good">âœ…</div><div><b>ì´ ìˆœì„œë¡œë§Œ ë³´ë©´ ë</b><div class="small">ì „ì²˜ë¦¬ â†’ ë¡œë” â†’ ëª¨ë¸ â†’ í•™ìŠµ â†’ í‰ê°€ â†’ ì‹œê°í™”</div></div></div><pre class='code'><code>1) Dataset ìƒì„±
   â”œâ”€ train_transform (ì¦ê°• í¬í•¨)
   â””â”€ test_transform  (í‰ê°€ìš© ìµœì†Œ ì „ì²˜ë¦¬)

2) DataLoader ìƒì„±
   â”œâ”€ train_loader: shuffle=True
   â””â”€ test_loader : shuffle=False

3) ëª¨ë¸ ì¤€ë¹„
   â”œâ”€ pretrained ëª¨ë¸ ë¡œë“œ (resnet18)
   â””â”€ ë§ˆì§€ë§‰ fc êµì²´: nn.Linear(in_features, n_output)

4) í•™ìŠµ(Train)
   â”œâ”€ outputs = net(images)
   â”œâ”€ loss = criterion(outputs, labels)
   â”œâ”€ running_loss += loss * batch_size
   â””â”€ epoch_loss = running_loss / total_samples

5) í‰ê°€(Eval)
   â”œâ”€ predicted = argmax(outputs, dim=1)
   â”œâ”€ c = (predicted == labels)  # ë§ì¶¤/í‹€ë¦¼ ë§ˆìŠ¤í¬
   â””â”€ í´ë˜ìŠ¤ë³„ë¡œ correct/total ëˆ„ì </code></pre></section><section class="card" id="codes"><h2>í•µì‹¬ ì½”ë“œ (ì£¼ì„ ë§ì´)</h2><div class="callout"><div class="icon warn">âš ï¸</div><div><b>ì¤‘ìš”</b><p class="small">ê¸°ì¡´ì— <kbd>plt.subplot</kbd>ì„ ì“°ë©´ ì¶•ì´ 1ê°œë§Œ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. ì—¬ëŸ¬ ì¹¸ì€ <kbd>plt.subplots</kbd>ê°€ ë§ì•„ìš”.</p></div></div><h3>A. ì „ì²˜ë¦¬ ë¶„ë¦¬ (Train vs Test)</h3><pre class='code'><code># âœ… ëª©í‘œ: í•™ìŠµ(train)ê³¼ í‰ê°€(test)ì— &quot;ë‹¤ë¥¸ ì „ì²˜ë¦¬&quot;ë¥¼ ì ìš©í•œë‹¤.
# - train: ë°ì´í„° ì¦ê°•(augmentation)ìœ¼ë¡œ ë‹¤ì–‘í•œ í˜•íƒœë¥¼ ë³´ì—¬ì¤˜ ì¼ë°˜í™” ì„±ëŠ¥â†‘
# - test : í‰ê°€ìš©ì´ë¯€ë¡œ &quot;í•­ìƒ ê°™ì€ ì¡°ê±´&quot;ìœ¼ë¡œë§Œ ì „ì²˜ë¦¬(ì¬í˜„ì„±â†‘)

from torchvision import transforms

train_transform = transforms.Compose([
    transforms.Resize((224, 224)),          # ëª¨ë¸ ì…ë ¥ í¬ê¸°ì— ë§ì¶¤ (ì˜ˆ: ResNet ê³„ì—´)
    transforms.RandomHorizontalFlip(p=0.5), # ì¢Œìš° ë°˜ì „ (í™•ë¥  50%) â†’ ì¦ê°•
    transforms.ToTensor(),                  # PIL ì´ë¯¸ì§€ â†’ Tensor(C,H,W), ê°’ ë²”ìœ„ [0,1]
    transforms.Normalize(mean=(0.5,0.5,0.5), std=(0.5,0.5,0.5))  # ê°’ ë²”ìœ„ ëŒ€ëµ [-1,1]
])

test_transform = transforms.Compose([
    transforms.Resize((224, 224)),
    transforms.ToTensor(),
    transforms.Normalize(mean=(0.5,0.5,0.5), std=(0.5,0.5,0.5))
])</code></pre><h3>B. DataLoader ì„¤ì • (shuffle ì°¨ì´)</h3><pre class='code'><code># âœ… ëª©í‘œ: ë°°ì¹˜(batch)ë¡œ ë‚˜ëˆ ì„œ í•™ìŠµì‹œí‚¤ê³ , trainì€ ì„ê³ (testëŠ” ë³´í†µ ì•ˆ ì„ìŒ)

from torch.utils.data import DataLoader

batch_size = 32

train_loader = DataLoader(
    train_dataset,
    batch_size=batch_size,
    shuffle=True,        # âœ… trainì€ ì„ê¸°(ì¤‘ìš”): í•™ìŠµì´ í•œìª½ ìˆœì„œì— ì¹˜ìš°ì¹˜ì§€ ì•ŠìŒ
    num_workers=2,
    pin_memory=True
)

test_loader = DataLoader(
    test_dataset,
    batch_size=batch_size,
    shuffle=False,       # âœ… testëŠ” ë³´í†µ ì„ì§€ ì•ŠìŒ: ê²°ê³¼ ì¬í˜„/ë””ë²„ê¹… ì‰¬ì›€
    num_workers=2,
    pin_memory=True
)</code></pre><h3>C. ì´ë¯¸ì§€ ì¶œë ¥ (denormalize + clamp + permute)</h3><pre class='code'><code># âœ… ëª©í‘œ: ì •ê·œí™”ëœ í…ì„œë¥¼ &quot;ì‚¬ëŒì´ ë³´ê¸° ì¢‹ê²Œ&quot; ë‹¤ì‹œ [0,1]ë¡œ ë˜ëŒë ¤ ì¶œë ¥í•œë‹¤.

import torch
import matplotlib.pyplot as plt

images, labels = next(iter(train_loader))  # ë°°ì¹˜ 1ê°œ êº¼ë‚´ê¸°
# images: (B, C, H, W)  ì˜ˆ: (32, 3, 224, 224)
# labels: (B,)

# 1) ì •ê·œí™” í•´ì œ(denormalize)
# Normalize(mean=0.5, std=0.5)ë¡œ í–ˆë‹¤ë©´,
# ì›ë³µ: x = x_norm * 0.5 + 0.5
images = images * 0.5 + 0.5

# 2) ì•ˆì „í•˜ê²Œ ê°’ ë²”ìœ„ë¥¼ [0,1]ë¡œ ì œí•œ (ì‹œê°í™” ê¹¨ì§ ë°©ì§€)
images = torch.clamp(images, 0, 1)

# 3) ì„œë¸Œí”Œë¡¯ ë§Œë“¤ê¸° (âš ï¸ subplotsê°€ ë§ìŒ)
num_images = 8
fig, axis = plt.subplots(2, 4, figsize=(12, 6))
axis = axis.ravel()  # (2,4) â†’ (8,) ë¡œ í‰íƒ„í™”

for i in range(num_images):
    # images[i]ëŠ” (C,H,W) í˜•íƒœ â†’ matplotlibì€ (H,W,C)ë¥¼ ì„ í˜¸
    img = images[i].permute(1, 2, 0).cpu().numpy()

    axis[i].imshow(img)
    axis[i].set_title(f&quot;label = {labels[i].item()}&quot;, fontsize=12)
    axis[i].axis(&quot;off&quot;)

plt.tight_layout()
plt.show()</code></pre><h3>D. Pretrained ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸° + FC êµì²´</h3><pre class='code'><code># âœ… ëª©í‘œ: pretrained ëª¨ë¸(ì˜ˆ: ResNet-18)ì„ ë¶ˆëŸ¬ì˜¤ê³ ,
# ë§ˆì§€ë§‰ ë¶„ë¥˜ê¸°(fc)ë¥¼ &quot;ìš°ë¦¬ í´ë˜ìŠ¤ ê°œìˆ˜(n_output)&quot;ì— ë§ê²Œ êµì²´í•œë‹¤.

import torch
import torch.nn as nn
from torchvision import models

# 1) ë‚œìˆ˜ ê³ ì •(ì¬í˜„ì„±)
def torch_seed(seed=42):
    import random, numpy as np
    random.seed(seed)
    np.random.seed(seed)
    torch.manual_seed(seed)
    torch.cuda.manual_seed_all(seed)

torch_seed(42)

# 2) pretrained ëª¨ë¸ ë¡œë“œ
net = models.resnet18(pretrained=True)

# 3) ê¸°ì¡´ fc ì…ë ¥ ì°¨ì› í™•ì¸ (ResNet-18ì€ ë³´í†µ 512)
fc_in_features = net.fc.in_features
print(&quot;ê¸°ì¡´ ì…ë ¥ ì°¨ì›:&quot;, fc_in_features)

# 4) ë§ˆì§€ë§‰ ì¶œë ¥ ë…¸ë“œ ìˆ˜ë¥¼ n_output(í´ë˜ìŠ¤ ê°œìˆ˜)ë¡œ êµì²´
n_output = 10  # ì˜ˆ: í´ë˜ìŠ¤ê°€ 10ê°œë©´ 10
net.fc = nn.Linear(fc_in_features, n_output)

print(&quot;êµì²´ëœ ë§ˆì§€ë§‰ ë ˆì´ì–´:&quot;, net.fc)</code></pre><h3>E. ì˜ˆì¸¡ í´ë˜ìŠ¤ ì¸ë±ìŠ¤ ë½‘ê¸° (torch.max / argmax)</h3><pre class='code'><code># âœ… outputsëŠ” ë³´í†µ (B, C) = (ë°°ì¹˜í¬ê¸°, í´ë˜ìŠ¤ê°œìˆ˜) ë¡œì§“/ì ìˆ˜
# ê° ìƒ˜í”Œë§ˆë‹¤ &quot;ê°€ì¥ í° ì ìˆ˜&quot;ë¥¼ ê°€ì§„ í´ë˜ìŠ¤ê°€ ì˜ˆì¸¡ í´ë˜ìŠ¤

outputs = net(images)  # (B, C)

# ë°©ë²• 1) torch.max
# _, predicted: predictedëŠ” &quot;ìµœëŒ“ê°’ ìœ„ì¹˜ì˜ ì¸ë±ìŠ¤&quot;
_, predicted = torch.max(outputs, dim=1)

# ë°©ë²• 2) torch.argmax (ë” ì§ê´€ì )
predicted2 = torch.argmax(outputs, dim=1)

# predicted / predicted2ëŠ” (B,) í˜•íƒœ, ê° ê°’ì€ 0~C-1 ì‚¬ì´</code></pre><h3>F. running_loss ëˆ„ì  &amp; epoch í‰ê·  loss</h3><pre class='code'><code># âœ… ì™œ loss.item()*batch_sizeë¥¼ ë”í•˜ë‚˜?
# - lossê°€ &#x27;ë°°ì¹˜ í‰ê· (mean)&#x27;ì¸ ê²½ìš°ê°€ ë§ìŒ
# - ë§ˆì§€ë§‰ ë°°ì¹˜ëŠ” batch_sizeê°€ ì‘ì„ ìˆ˜ ìˆì–´ì„œ,
#   ë‹¨ìˆœíˆ ë°°ì¹˜ í‰ê· ë¼ë¦¬ í‰ê· ë‚´ë©´ ì™œê³¡ë¨
# - ê·¸ë˜ì„œ &quot;ìƒ˜í”Œ ê°œìˆ˜ë¡œ ê°€ì¤‘ì¹˜&quot;ë¥¼ ì£¼ê¸° ìœ„í•´ batch_sizeë¥¼ ê³±í•¨

running_loss = 0.0
total = 0

net.train()

for images, labels in train_loader:
    outputs = net(images)
    loss = criterion(outputs, labels)   # ë³´í†µ reduction=&#x27;mean&#x27; â†’ ë°°ì¹˜ í‰ê·  ì†ì‹¤

    # âœ… ë°°ì¹˜ í‰ê·  loss Ã— ë°°ì¹˜ ìƒ˜í”Œ ìˆ˜ â†’ &#x27;ë°°ì¹˜ ì†ì‹¤ í•©&#x27;ì²˜ëŸ¼ ëˆ„ì 
    running_loss += loss.item() * images.size(0)

    # âœ… ì „ì²´ ìƒ˜í”Œ ìˆ˜ ëˆ„ì 
    total += labels.size(0)

epoch_loss = running_loss / total
print(&quot;epoch í‰ê·  loss =&quot;, epoch_loss)</code></pre><h3>G. í´ë˜ìŠ¤ë³„ ì •í™•ë„ ì§‘ê³„ (label ê¸°ì¤€ìœ¼ë¡œ ë¬¶ê¸°)</h3><pre class='code'><code># âœ… í¬ì¸íŠ¸:
# &#x27;ìˆœì„œëŒ€ë¡œ&#x27; ì„¸ëŠ” ê²Œ ì•„ë‹ˆë¼,
# labels[i] (ì •ë‹µ í´ë˜ìŠ¤ ë²ˆí˜¸) ë¥¼ ë³´ê³  í•´ë‹¹ í´ë˜ìŠ¤ ì¹¸ì— ëˆ„ì í•œë‹¤.

num_classes = len(classes)
class_correct = [0] * num_classes
class_total   = [0] * num_classes

net.eval()
with torch.no_grad():
    for images, labels in test_loader:
        outputs = net(images)

        _, predicted = torch.max(outputs, dim=1)  # (B,)
        c = (predicted == labels)                  # (B,) bool â†’ ë§ìœ¼ë©´ True

        for i in range(labels.size(0)):
            label = labels[i].item()              # ì •ë‹µ í´ë˜ìŠ¤ ë²ˆí˜¸ (0~C-1)

            class_correct[label] += int(c[i].item())  # Trueâ†’1, Falseâ†’0
            class_total[label] += 1

# í´ë˜ìŠ¤ë³„ ì •í™•ë„ ì¶œë ¥
for k in range(num_classes):
    acc = class_correct[k] / max(1, class_total[k])
    print(f&quot;{classes[k]}: {acc:.3f} ({class_correct[k]}/{class_total[k]})&quot;)</code></pre></section><section class="card" id="pitfalls"><h2>ìì£¼ ë‚˜ëŠ” ì‹¤ìˆ˜ (ì—ëŸ¬ ë©”ì‹œì§€ ê¸°ì¤€)</h2><div class="callout"><div class="icon warn">ğŸ§¯</div><div><b>ì—ëŸ¬ëŠ” â€œì›ì¸ â†’ í•´ê²°â€ì„ ë”± 2ì¤„ë¡œ ê³ ì •</b><p class="small">ë‚˜ì¤‘ì— ë³´ê³ ì„œ ì“¸ ë•Œë„ ì´ í‘œë¥¼ ê·¸ëŒ€ë¡œ ì“°ë©´ ì •ë¦¬ ì†ë„ê°€ ë¹¨ë¼ì§‘ë‹ˆë‹¤.</p></div></div><table><tr><th>ì¦ìƒ(ì—ëŸ¬/í˜„ìƒ)</th><th>ì›ì¸</th><th>í•´ê²°</th></tr><tr><td>IndexError: index 8 is out of bounds for axis 0 with size 8</td><td>2x4 subplotì€ 8ì¹¸ì¸ë° num_images=10ìœ¼ë¡œ ë” ë§ì´ ê·¸ë¦¬ë ¤ê³  í•´ì„œ ë°œìƒ</td><td>num_images=min(num_images,len(axis)) ë˜ëŠ” rows/colsë¥¼ num_imagesì— ë§ì¶° ë™ì ìœ¼ë¡œ ìƒì„±</td></tr><tr><td>classes[labels[i]]ì—ì„œ ì—ëŸ¬/ì´ìƒ ë™ì‘</td><td>labels[i]ê°€ tensorì¼ ë•Œ íŒŒì´ì¬ ë¦¬ìŠ¤íŠ¸ ì¸ë±ì‹±ì´ ë¶ˆì•ˆì •í•  ìˆ˜ ìˆìŒ</td><td>classes[labels[i].item()] ì²˜ëŸ¼ .item()ìœ¼ë¡œ ì •ìˆ˜ë¡œ ë³€í™˜</td></tr><tr><td>.numpy() ë³€í™˜ ì—ëŸ¬ (CUDA)</td><td>GPU í…ì„œëŠ” ë°”ë¡œ numpyë¡œ ë³€í™˜ ë¶ˆê°€</td><td>img = tensor.cpu().numpy()</td></tr></table></section><section class="card" id="template"><h2>ë³´ê³ ì„œ í¬ë§· í…œí”Œë¦¿ (ì•ìœ¼ë¡œ ê³„ì† ì´ëŒ€ë¡œ)</h2><div class="callout"><div class="icon purple">ğŸ“Œ</div><div><b>ê³ ì • í¬ë§·</b><p class="small">âœ… ì•ìœ¼ë¡œë„ ê°™ì€ í¬ë§·ìœ¼ë¡œ ì“°ë ¤ë©´ ì•„ë˜ ìˆœì„œë§Œ ê³ ì •í•˜ë©´ ë©ë‹ˆë‹¤.

1) ì œëª©/ë‚ ì§œ/í™˜ê²½
2) í•™ìŠµ ëª©í‘œ(2~4ì¤„)
3) í•µì‹¬ ê°œë…(ë¶ˆë¦¿ 6~10ê°œ, ì´ˆì‹¬ì ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…)
4) ì „ì²´ íë¦„(1~2ë¶„ ì»·ìœ¼ë¡œ ë³´ëŠ” ë‹¨ê³„ ìš”ì•½)
5) í•µì‹¬ ì½”ë“œ(ì „ì²˜ë¦¬ â†’ ë¡œë” â†’ ëª¨ë¸ â†’ í•™ìŠµ â†’ í‰ê°€ â†’ ì‹œê°í™” ìˆœì„œ)
6) ìì£¼ ë‚˜ëŠ” ì‹¤ìˆ˜(ì—ëŸ¬ ë©”ì‹œì§€, ì›ì¸, í•´ê²°)
7) ë‹¤ìŒ ì•¡ì…˜(ë‹¤ìŒ ì°¨ì‹œì—ì„œ í™•ì¸í•  ê²ƒ)

ì•„ë˜ HTML ìŠ¤ì¼ˆë ˆí†¤ì€ ê·¸ëŒ€ë¡œ ë³µë¶™í•´ì„œ ì‚¬ìš©í•˜ì„¸ìš”.</p></div></div><pre class='code'><code>&lt;section class=&quot;card&quot; id=&quot;XX&quot;&gt;
  &lt;h2&gt;XXì°¨ì‹œ í•µì‹¬ ì½”ë“œ ë³´ê³ ì„œ&lt;/h2&gt;
  &lt;p class=&quot;meta&quot;&gt;ì‘ì„±ì¼: YYYY-MM-DD Â· í™˜ê²½: PyTorch/torchvision Â· ëª¨ë¸: (ì˜ˆ: ResNet-18)&lt;/p&gt;

  &lt;div class=&quot;callout&quot;&gt;
    &lt;div class=&quot;icon cyan&quot;&gt;ğŸ¯&lt;/div&gt;
    &lt;div&gt;
      &lt;b&gt;í•™ìŠµ ëª©í‘œ&lt;/b&gt;
      &lt;ul&gt;
        &lt;li&gt;...&lt;/li&gt;
        &lt;li&gt;...&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;h3&gt;í•µì‹¬ ê°œë…&lt;/h3&gt;
  &lt;ul&gt;
    &lt;li&gt;...&lt;/li&gt;
  &lt;/ul&gt;

  &lt;h3&gt;ì „ì²´ íë¦„&lt;/h3&gt;
  &lt;pre class=&quot;code&quot;&gt;&lt;code&gt;...&lt;/code&gt;&lt;/pre&gt;

  &lt;h3&gt;í•µì‹¬ ì½”ë“œ&lt;/h3&gt;
  &lt;pre class=&quot;code&quot;&gt;&lt;code&gt;...&lt;/code&gt;&lt;/pre&gt;

  &lt;h3&gt;ìì£¼ ë‚˜ëŠ” ì‹¤ìˆ˜&lt;/h3&gt;
  &lt;table&gt;
    &lt;tr&gt;&lt;th&gt;ì¦ìƒ&lt;/th&gt;&lt;th&gt;ì›ì¸&lt;/th&gt;&lt;th&gt;í•´ê²°&lt;/th&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;...&lt;/td&gt;&lt;td&gt;...&lt;/td&gt;&lt;td&gt;...&lt;/td&gt;&lt;/tr&gt;
  &lt;/table&gt;

  &lt;h3&gt;ë‹¤ìŒ ì•¡ì…˜&lt;/h3&gt;
  &lt;ul&gt;
    &lt;li&gt;...&lt;/li&gt;
  &lt;/ul&gt;
&lt;/section&gt;</code></pre></section>
<footer>
  <p>ë‹¨ì¼ HTML(ë‚´ì¥ CSS) íŒŒì¼ì…ë‹ˆë‹¤. GitHub Pagesë¡œ ì˜¬ë ¤ë„ ê·¸ëŒ€ë¡œ ìŠ¤íƒ€ì¼ì´ ìœ ì§€ë©ë‹ˆë‹¤.</p>
</footer>

  </main>
</div>
</div>
</body>
</html>
